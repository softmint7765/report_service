{"ast":null,"code":"'use strict';\n\nvar path = require('path');\nvar fs = require('graceful-fs');\nvar MASK_MODE = parseInt('7777', 8);\nvar DEFAULT_DIR_MODE = parseInt('0777', 8);\nfunction mkdirp(dirpath, customMode, callback) {\n  if (typeof customMode === 'function') {\n    callback = customMode;\n    customMode = undefined;\n  }\n  var mode = customMode || DEFAULT_DIR_MODE & ~process.umask();\n  dirpath = path.resolve(dirpath);\n  fs.mkdir(dirpath, mode, onMkdir);\n  function onMkdir(mkdirErr) {\n    if (!mkdirErr) {\n      return fs.stat(dirpath, onStat);\n    }\n    switch (mkdirErr.code) {\n      case 'ENOENT':\n        {\n          return mkdirp(path.dirname(dirpath), onRecurse);\n        }\n      case 'EEXIST':\n        {\n          return fs.stat(dirpath, onStat);\n        }\n      default:\n        {\n          return callback(mkdirErr);\n        }\n    }\n    function onStat(statErr, stats) {\n      if (statErr) {\n        return callback(statErr);\n      }\n      if (!stats.isDirectory()) {\n        return callback(mkdirErr);\n      }\n\n      // TODO: Is it proper to mask like this?\n      if ((stats.mode & MASK_MODE) === mode) {\n        return callback();\n      }\n      if (!customMode) {\n        return callback();\n      }\n      fs.chmod(dirpath, mode, callback);\n    }\n  }\n  function onRecurse(recurseErr) {\n    if (recurseErr) {\n      return callback(recurseErr);\n    }\n    mkdirp(dirpath, mode, callback);\n  }\n}\nmodule.exports = mkdirp;","map":null,"metadata":{},"sourceType":"script","externalDependencies":[]}